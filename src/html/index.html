<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Recent Work Gallery</title>
        <link rel="stylesheet" type="text/css" href="../css/recent_work_gallery.css" media="all">
    </head>
    <body>
        <div id="container">
            <div class="top_bars">
                <div class="ti_wrapper">
                    <div class="ti_slide">
                        <div class="ti_content">
                            <div class="ti_news"><img src="../img/top_bar/e16.png" /></div>
                            <div class="ti_news"><img src="../img/top_bar/e03.png" /></div>
                            <div class="ti_news"><img src="../img/top_bar/bar-edit-01.png" /></div>
                            <div class="ti_news"><img src="../img/top_bar/e01.png" /></div>
                            <div class="ti_news"><img src="../img/top_bar/bar-edit-02.png" /></div>
                            <div class="ti_news"><img src="../img/top_bar/e03.png" /></div>
                            <div class="ti_news"><img src="../img/top_bar/bar-edit-03.png" /></div>
                            <div class="ti_news"><img src="../img/top_bar/e03.png" /></div>
                            <div class="ti_news"><img src="../img/top_bar/bar-04-01.png" /></div>
                            <div class="ti_news">
                                <a href="http://recentworkgallery.com" target="_blank">
                                    <img src="../img/top_bar/bar-04-02.png" />
                                </a>
                            </div>
                            <div class="ti_news"><img src="../img/top_bar/bar-04-03.png" /></div>
                            <div class="ti_news"><img src="../img/top_bar/e02.png" /></div>
                            <div class="ti_news"><img src="../img/top_bar/e02.png" /></div>
                            <div class="ti_news"><img src="../img/top_bar/e02.png" /></div>
                            <div class="ti_news"><img src="../img/top_bar/bar-04-01.png" /></div>
                            <div class="ti_news">
                                <a href="http://recentworkgallery.com" target="_blank">
                                    <img src="../img/top_bar/bar-05-02.png" />
                                </a>
                            </div>
                            <div class="ti_news"><img src="../img/top_bar/bar-04-03.png" /></div>
                            <div class="ti_news"><img src="../img/top_bar/e03.png" /></div>
                            <div class="ti_news"><img src="../img/top_bar/bar-edit-06.png" /></div>
                            <div class="ti_news"><img src="../img/top_bar/e03.png" /></div>
                            <div class="ti_news"><img src="../img/top_bar/bar-04-01.png" /></div>
                            <div class="ti_news">
                                <a href="http://thisweekendroom.com/wp/" target="_blank">
                                    <img src="../img/top_bar/bar-07-02.png" />
                                </a>
                            </div>
                            <div class="ti_news"><img src="../img/top_bar/bar-04-03.png" /></div>
                            <div class="ti_news"><img src="../img/top_bar/e04.png" /></div>
                            <div class="ti_news"><img src="../img/top_bar/e05.png" /></div>
                            <div class="ti_news"><img src="../img/top_bar/e06.png" /></div>
                            <div class="ti_news"><img src="../img/top_bar/e07.png" /></div>
                            <div class="ti_news"><img src="../img/top_bar/e07.png" /></div>
                            <div class="ti_news"><img src="../img/top_bar/e08.png" /></div>
                            <div class="ti_news"><img src="../img/top_bar/e09.png" /></div>
                            <div class="ti_news"><img src="../img/top_bar/e05.png" /></div>
                            <div class="ti_news"><img src="../img/top_bar/e10.png" /></div>
                            <div class="ti_news"><img src="../img/top_bar/e11.png" /></div>
                            <div class="ti_news"><img src="../img/top_bar/e12.png" /></div>
                            <div class="ti_news"><img src="../img/top_bar/e05.png" /></div>
                            <div class="ti_news"><img src="../img/top_bar/e05.png" /></div>
                            <div class="ti_news"><img src="../img/top_bar/e13.png" /></div>
                            <div class="ti_news"><img src="../img/top_bar/e14.png" /></div>
                            <div class="ti_news"><img src="../img/top_bar/e15.png" /></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="typing_box">
                <a href="javascript:;">
                    <img src="../img/typing_box_icon/type.png" />
                </a>
            </div>
        </div>
        <div class="poster_info" style="display:none;z-index:0">
            <div class="poster"></div>
            <div class="info">
                <div class="placename"></div>
                <div class="address"></div>
                <div class="writer"></div>
                <div class="date"></div>
            </div>
        </div>
        <div class="poster_caching" style="display:none;"></div>
        <div id="map_canvas"></div>
        <script type="text/javascript"src="//ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
        <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
        <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery.lazyload/1.9.1/jquery.lazyload.min.js"></script>
        <script type="text/javascript" src="//maps.googleapis.com/maps/api/js?key=AIzaSyC6hq7y2J0s50N7YFwmNrIi8k88KIVZG6Y&callback=initMap" async defer></script>
        <script type="text/javascript" src="../js/jquery.tickerNews.min.js"></script>
        <script type="text/javascript" src="../js/poster_data.js"></script>
        <script type="text/javascript">
            var iconInterval = null;
            var posterInterval = null;
            function initMap(){
                var mapOptions = {
                    zoom: 12,
                    center: new google.maps.LatLng(37.5518842,126.9885983),
                    mapTypeId: google.maps.MapTypeId.ROADMAP,
                    disableDefaultUI: true,
                    //zoomControl: false,
                    //scaleControl: false,
                    //scrollwheel: false,
                    disableDoubleClickZoom: true
                    //draggable: false
                };
                var map = new google.maps.Map($('#map_canvas')[0], mapOptions);

                map.addListener('click', function(){
                    $('.poster_info').hide();
                    for(var i in displays){
                        displays[i].marker.setIcon(displays[i].icon);
                    }
                });

                for(var i in displays){
                    displays[i].marker = new google.maps.Marker({
                        position: new google.maps.LatLng(displays[i].position[0], displays[i].position[1]),
                        icon: displays[i].icon,
                        zIndex:101,
                        map: map
                    });

                    google.maps.event.addListener(displays[i].marker, 'click', (function(marker, i){
                        return function(e){
                            map.setCenter(e.latLng);
                            appendPosterInfo(displays[i], displays[i].poster_index, 0);
                            for(var j in displays){
                                if(j !== i){
                                    displays[j].marker.setIcon(icons['3']);
                                }else{
                                    displays[j].marker.setIcon(displays[j].icon);
                                }
                            }
                        }
                    })(displays[i].marker, i));
                }
            }
            function appendPosterInfo(display, poster_index, poster_sub_index){
                var poster = '';
                if($.isArray(display_posters[poster_index].poster) === true){
                    poster = display_posters[poster_index].poster[poster_sub_index];
                }else{
                    poster = display_posters[poster_index].poster;
                }
                if(display !== null){
                    $('.poster_info').css('z-index',0);
                    var poster_html = '<img id="poster_'+poster_index+'_'+poster_sub_index+'" data-display-type="'+display.type+'" class="lazy" data-original="'+poster+'" style="width:100%" />';
                    if(display.type === 'all' || display.type === 'multi'){
                        poster_html += '<div class="prev"><a href="javascript:;"><img src="../img/image_slide_arrow/arrow_prev.png" /></a></div>';
                        poster_html += '<div class="next"><a href="javascript:;"><img src="../img/image_slide_arrow/arrow_next.png" /></a></div>';
                        autoPoster();
                    }

                    $('.poster_info .poster').html(poster_html);
                    $('.poster_info .poster').draggable();

                    $('.poster_info .info .placename').text(display.placename);
                    $('.poster_info .info .address').text(display.address);
                    $('.poster_info .info .writer').html(display_posters[poster_index].writer+' <span>\''+display_posters[poster_index].title+'\'</span>');
                    $('.poster_info .info .date').text(display.date);
                }else{
                    $('.poster_info .poster img.lazy').attr('data-original', poster);
                    $('.poster_info .poster img.lazy').attr('id', 'poster_'+poster_index+'_'+poster_sub_index);
                    $('.poster_info .info .writer').html(display_posters[poster_index].writer+' <span>\''+display_posters[poster_index].title+'\'</span>');
                }
                $('.poster_info .poster img.lazy').lazyload({
                    load:function(){
                        $('.poster_info .poster').css('height', $('.poster_info .poster img').height());
                        $('.poster_info').css({
                            'top':($(window).height()-$('.poster_info').height()-50)+'px',
                            'z-index':1
                        });
                        $('.poster_info .poster .prev, .poster_info .poster .next').css('top', (Math.ceil($('.poster_info').height()/2)-50)+'px');
                    }
                });
                $('.poster_info').show();
                $(window).resize();
            }

            function autoPoster(){
                clearInterval(posterInterval);
                posterInterval = window.setInterval(function(){
                    $('.poster_info .poster .next a').trigger('click');
                }, posterIntervalTime);
            }

            $(document).ready(function(){
                $('.top_bars').newsTicker();

                $('#map_canvas').click(function(e){
                    $('.emoji').remove();
                });

                $('.typing_box a').click(function(e){
                    e.preventDefault();
                    window.open('./text_area_popup.html', 'TextArea', 'top=0,left=0,width=500,height=500');
                });

                for(var i in display_posters){
                    if($.isArray(display_posters[i].poster) === true){
                        for(var j in display_posters[i].poster){
                            $('.poster_caching').append('<img src="'+display_posters[i].poster[j]+'" />');
                        }
                    }else{
                        $('.poster_caching').append('<img src="'+display_posters[i].poster+'" />');
                    }
                }

                iconInterval = window.setInterval(function(){
                    var emoji_top_max = ($(window).height()-50);
                    var emoji_top_min = 70;
                    var emoji_left_max = ($(window).width()-50);
                    var emoji_left_min = 0;
                    var emoji_top = Math.floor(Math.random() * (emoji_top_max-emoji_top_min+1))+emoji_top_min;
                    var emoji_left = Math.floor(Math.random() * (emoji_left_max-emoji_left_min+1))+emoji_left_min;
                    var emoji_name = Math.floor(Math.random() * (50-1))+1;
                    if(emoji_name < 10){
                        emoji_name = '0'+emoji_name;
                    }
                    var emoji_html = '<div class="emoji" style="top:'+emoji_top+'px;left:'+emoji_left+'px"><img src="../img/emoji/'+emoji_name+'.png" /></div>';
                    $('body').append(emoji_html);

                    $('.emoji').draggable({
                        containment:'window',
                        scroll:false
                    });
                }, iconIntervalTime);

                $(document).on('mouseenter', '.poster_info', function(){
                    clearInterval(posterInterval);
                });

                $(document).on('mouseleave', '.poster_info', function(){
                    autoPoster();
                });

                $(document).on('click', '.poster_info .poster .prev a', function(e){
                    e.preventDefault();
                    var poster_index = $('.poster_info .poster img').attr('id').replace('poster_', '');
                    var poster_display_type = $('.poster_info .poster img').attr('data-display-type');
                    poster_index = poster_index.split('_');
                    poster_index[0] = parseInt(poster_index[0]);
                    poster_index[1] = parseInt(poster_index[1]);
                    var prev_poster_index = 0;
                    var prev_poster_sub_index = 0;
                    if(poster_display_type === 'multi' && $.isArray(display_posters[poster_index[0]].poster) === true){
                        prev_poster_index = poster_index[0];
                        if(poster_index[1] === 0){
                            prev_poster_sub_index = (display_posters[poster_index[0]].poster.length-1);
                        }else{
                            prev_poster_sub_index = (poster_index[1]-1);
                        }
                    }else{
                        if(poster_index[0] === 0){
                            prev_poster_index = (display_posters.length-1);
                        }else{
                            prev_poster_index = (poster_index[0]-1);
                        }
                    }

                    appendPosterInfo(null, prev_poster_index, prev_poster_sub_index);
                });

                $(document).on('click', '.poster_info .poster .next a', function(e){
                    e.preventDefault();
                    var poster_index = $('.poster_info .poster img').attr('id').replace('poster_', '');
                    var poster_display_type = $('.poster_info .poster img').attr('data-display-type');
                    poster_index = poster_index.split('_');
                    poster_index[0] = parseInt(poster_index[0]);
                    poster_index[1] = parseInt(poster_index[1]);
                    var next_poster_index = 0;
                    var next_poster_sub_index = 0;
                    if(poster_display_type === 'multi' && $.isArray(display_posters[poster_index[0]].poster) === true){
                        next_poster_index = poster_index[0];
                        if(poster_index[1] === (display_posters[next_poster_index].poster.length-1)){
                            next_poster_sub_index = 0;
                        }else{
                            next_poster_sub_index = (poster_index[1]+1);
                        }
                    }else{
                        if(poster_index[0] === (display_posters.length-1)){
                            next_poster_index = 0;
                        }else{
                            next_poster_index = (poster_index[0]+1);
                        }
                    }

                    appendPosterInfo(null, next_poster_index, next_poster_sub_index);
                });
            });
        </script>
    </body>
</html>